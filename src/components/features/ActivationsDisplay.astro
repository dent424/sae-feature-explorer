---
import { parseContext, formatToken } from '../../lib/data';

interface ActivationData {
  context: string;
  active_token: string;
  activation: number;
}

interface Props {
  activations: ActivationData[];
}

const { activations } = Astro.props;
---

<div class="space-y-4">
  {activations.slice(0, 15).map((act, idx) => {
    const { before, token, after } = parseContext(act.context);
    const { display: tokenDisplay, isSpecial } = formatToken(act.active_token);

    return (
      <div class="border border-gray-200 rounded-lg p-4 hover:border-gray-300">
        <div class="flex justify-between items-start mb-2">
          <span class="text-xs text-gray-400">Example {idx + 1}</span>
          <span class="text-sm font-medium text-blue-600">
            Activation: {act.activation.toFixed(4)}
          </span>
        </div>
        <div class="font-mono text-sm bg-gray-50 p-3 rounded overflow-x-auto whitespace-pre-wrap">
          <span class="text-gray-600">{before}</span>
          <span class="bg-yellow-200 px-1 rounded font-semibold">
            {token || (isSpecial ? (
              <span class="bg-gray-300 text-gray-700 px-1 rounded text-xs">{tokenDisplay}</span>
            ) : tokenDisplay)}
          </span>
          <span class="text-gray-600">{after}</span>
        </div>
        <div class="mt-2 text-xs text-gray-500">
          Active token: {isSpecial ? (
            <span class="bg-gray-200 text-gray-700 px-1 rounded">{tokenDisplay}</span>
          ) : (
            <span class="font-mono">"{act.active_token}"</span>
          )}
        </div>
      </div>
    );
  })}
</div>
